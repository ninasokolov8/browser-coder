; PHP Security Configuration for Sandboxed Code Execution
; This file disables all dangerous functions at the PHP level

; Disable dangerous functions
disable_functions = exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source,proc_close,proc_get_status,proc_nice,proc_terminate,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,phpinfo,eval,assert,create_function,call_user_func,call_user_func_array,usort,uasort,uksort,array_filter,array_reduce,array_map,array_walk,array_walk_recursive,file_get_contents,file_put_contents,file,readfile,fopen,fwrite,fputs,fread,fgets,fgetc,fclose,fsockopen,pfsockopen,stream_socket_client,stream_socket_server,socket_create,socket_connect,socket_write,socket_read,socket_close,mail,dl,ini_set,ini_get,ini_alter,ini_restore,get_cfg_var,putenv,getenv,chdir,chroot,getcwd,scandir,glob,opendir,readdir,closedir,dir,mkdir,rmdir,unlink,rename,copy,link,symlink,chmod,chown,chgrp,touch,ftruncate,posix_mkfifo,posix_getlogin,posix_ttyname,getmyuid,getmygid,getmypid,getmyinode,getlastmod,highlight_file,virtual,apache_child_terminate,apache_get_modules,apache_get_version,apache_request_headers,apache_reset_timeout,apache_response_headers,apache_setenv,set_include_path,restore_include_path

; Disable file uploads
file_uploads = Off

; Disable URL file wrappers
allow_url_fopen = Off
allow_url_include = Off

; Memory limit
memory_limit = 64M

; Max execution time
max_execution_time = 10

; Disable opening remote files
; open_basedir is set to restrict file access (set via command line)

; Disable error display in output (but log them)
display_errors = Off
display_startup_errors = Off
log_errors = On

; Disable dangerous features
expose_php = Off
register_globals = Off
magic_quotes_gpc = Off

; Prevent session hijacking
session.cookie_httponly = 1
session.use_only_cookies = 1
